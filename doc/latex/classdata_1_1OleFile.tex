\hypertarget{classdata_1_1OleFile}{}\doxysection{data.\+Ole\+File Class Reference}
\label{classdata_1_1OleFile}\index{data.OleFile@{data.OleFile}}


Inheritance diagram for data.\+Ole\+File\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=154pt]{classdata_1_1OleFile__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for data.\+Ole\+File\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=252pt]{classdata_1_1OleFile__coll__graph}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classdata_1_1OleFile_ab6e47a520da928ed4c1a9410e8286232}{Ole\+File}} ()
\item 
\mbox{\hyperlink{classdata_1_1OleFile_a9abcd831b45b8217082c84988ce2b694}{Ole\+File}} (\mbox{\hyperlink{classdata_1_1Ole}{Ole}} o)
\item 
\mbox{\hyperlink{classdata_1_1OleFile}{Ole\+File}} \mbox{\hyperlink{classdata_1_1OleFile_aaf32e7bf59aafd720258d95446be5944}{load\+File}} (String fullfilename)
\item 
boolean \mbox{\hyperlink{classdata_1_1OleFile_a98baacb5ed18c06071deeb652a71a334}{save\+File}} (String outputfolder)
\item 
boolean \mbox{\hyperlink{classdata_1_1OleFile_ab8ec9bb26796b85088a2854fc0dd6b46}{save\+As\+File}} (String outputfolder, String newname, boolean plainjson)
\item 
\mbox{\Hypertarget{classdata_1_1OleFile_a118b696d102b074dacd858cd80bce34b}\label{classdata_1_1OleFile_a118b696d102b074dacd858cd80bce34b}} 
String {\bfseries get\+String\+Content} ()
\item 
\mbox{\Hypertarget{classdata_1_1OleFile_a255e0f7805d3667a15ce132e31fee60d}\label{classdata_1_1OleFile_a255e0f7805d3667a15ce132e31fee60d}} 
String {\bfseries get\+File\+Name} ()
\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}
Subclass of \mbox{\hyperlink{classdata_1_1Ole}{Ole}} for reading, writing and transferring files through A\+S\+C\+II messages. It reads the files byte to byte so it can be used for both text and binary files. It is based on two fields one for the name of the file and other for the content. The name of the file contains just the name with the extension and any path indication is removed. The content is encoded as an array of bytes.

Since methods for loading and saving have been override, there is only two possible ways for saving and reading a file, either as binary content or as encrypted contemt, therefore, the Json serialization is nor explicitly dealt with. 

Definition at line 32 of file Ole\+File.\+java.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classdata_1_1OleFile_ab6e47a520da928ed4c1a9410e8286232}\label{classdata_1_1OleFile_ab6e47a520da928ed4c1a9410e8286232}} 
\index{data.OleFile@{data.OleFile}!OleFile@{OleFile}}
\index{OleFile@{OleFile}!data.OleFile@{data.OleFile}}
\doxysubsubsection{\texorpdfstring{OleFile()}{OleFile()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily data.\+Ole\+File.\+Ole\+File (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Basic constructor. It defines the specific fields of this object 

Definition at line 37 of file Ole\+File.\+java.


\begin{DoxyCode}{0}
\DoxyCodeLine{37                      \{}
\DoxyCodeLine{38         super();}
\DoxyCodeLine{39         addField(\textcolor{stringliteral}{"filename"});}
\DoxyCodeLine{40         addField(\textcolor{stringliteral}{"filedata"});}
\DoxyCodeLine{41         setType(oletype.OLEFILE.name());}
\DoxyCodeLine{42     \}}

\end{DoxyCode}
\mbox{\Hypertarget{classdata_1_1OleFile_a9abcd831b45b8217082c84988ce2b694}\label{classdata_1_1OleFile_a9abcd831b45b8217082c84988ce2b694}} 
\index{data.OleFile@{data.OleFile}!OleFile@{OleFile}}
\index{OleFile@{OleFile}!data.OleFile@{data.OleFile}}
\doxysubsubsection{\texorpdfstring{OleFile()}{OleFile()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily data.\+Ole\+File.\+Ole\+File (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classdata_1_1Ole}{Ole}}}]{o }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Copy constructor 
\begin{DoxyParams}{Parameters}
{\em o} & The \mbox{\hyperlink{classdata_1_1Ole}{Ole}} object to be cloned \\
\hline
\end{DoxyParams}


Definition at line 48 of file Ole\+File.\+java.


\begin{DoxyCode}{0}
\DoxyCodeLine{48                           \{}
\DoxyCodeLine{49         super(o);}
\DoxyCodeLine{50         addField(\textcolor{stringliteral}{"filename"});}
\DoxyCodeLine{51         addField(\textcolor{stringliteral}{"filedata"});}
\DoxyCodeLine{52         setType(oletype.OLEFILE.name());}
\DoxyCodeLine{53     \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classdata_1_1OleFile_aaf32e7bf59aafd720258d95446be5944}\label{classdata_1_1OleFile_aaf32e7bf59aafd720258d95446be5944}} 
\index{data.OleFile@{data.OleFile}!loadFile@{loadFile}}
\index{loadFile@{loadFile}!data.OleFile@{data.OleFile}}
\doxysubsubsection{\texorpdfstring{loadFile()}{loadFile()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classdata_1_1OleFile}{Ole\+File}} data.\+Ole\+File.\+load\+File (\begin{DoxyParamCaption}\item[{String}]{fullfilename }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

It takes the binary (byte\mbox{[}\mbox{]}) content of any file, dump it as an integer Json Array. It encapsulates not only the binary content (key \char`\"{}filedata\char`\"{}) but also the original filename (key \char`\"{}filename\char`\"{}, just the filename, without the path to it


\begin{DoxyParams}{Parameters}
{\em fullfilename} & Name of the file to load, including any possible acces path. However, the path will be ignored and only the name and extension will be memorized \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
An ole object that encapsulates the content of the file. If an error occured during the load of fila, an empty \mbox{\hyperlink{classdata_1_1Ole}{Ole}} object is returned instead 
\end{DoxyReturn}


Reimplemented from \mbox{\hyperlink{classdata_1_1Ole_a633c39193af31febc64027f8bf5c6b97}{data.\+Ole}}.



Definition at line 68 of file Ole\+File.\+java.


\begin{DoxyCode}{0}
\DoxyCodeLine{68                                                  \{}
\DoxyCodeLine{69         \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{70             ArrayList <Integer> arraydata = \textcolor{keyword}{new} ArrayList();}
\DoxyCodeLine{71             Path path = Paths.get(fullfilename);}
\DoxyCodeLine{72             \textcolor{comment}{// Read all bytes}}
\DoxyCodeLine{73             \textcolor{keywordtype}{byte}[] bytedata = Files.readAllBytes(path);}
\DoxyCodeLine{74             \textcolor{comment}{// If encrypted, first transform the byte sequence into a String,}}
\DoxyCodeLine{75             \textcolor{comment}{// decrypt it, and back to a sequence of bytes}}
\DoxyCodeLine{76             \textcolor{keywordflow}{if} (isEncrypted()) \{}
\DoxyCodeLine{77                 Cryptor enigma = \textcolor{keyword}{new} Cryptor(meta().\mbox{\hyperlink{classdata_1_1Ole_a06b1a759588ab32503e78b2b281c4691}{getString}}(\textcolor{stringliteral}{"crypto"}, \textcolor{stringliteral}{""}));}
\DoxyCodeLine{78                 String scontent = \textcolor{keyword}{new} String(bytedata, enigma.getCharSet()),}
\DoxyCodeLine{79                         crypcontent = enigma.deCrypt(scontent);}
\DoxyCodeLine{80                 bytedata = crypcontent.getBytes();}
\DoxyCodeLine{81             \}}
\DoxyCodeLine{82             \textcolor{comment}{// Stores the byte sequence as a JsonArray}}
\DoxyCodeLine{83             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < bytedata.length; i++) \{}
\DoxyCodeLine{84                 arraydata.add((\textcolor{keywordtype}{int}) bytedata[i]);}
\DoxyCodeLine{85             \}}
\DoxyCodeLine{86             \mbox{\hyperlink{classdata_1_1Ole_ad39e69cdfe412827985704e9b971f5d6}{setField}}(\textcolor{stringliteral}{"filename"}, path.getFileName().toString());}
\DoxyCodeLine{87             \mbox{\hyperlink{classdata_1_1Ole_ad39e69cdfe412827985704e9b971f5d6}{setField}}(\textcolor{stringliteral}{"filedata"}, \textcolor{keyword}{new} ArrayList(arraydata));}
\DoxyCodeLine{88 \textcolor{comment}{//            System.out.println(this.toString());}}
\DoxyCodeLine{89         \} \textcolor{keywordflow}{catch} (IOException ex) \{}
\DoxyCodeLine{90             System.err.println(ex.toString());}
\DoxyCodeLine{91         \}}
\DoxyCodeLine{92         \textcolor{keywordflow}{return} \textcolor{keyword}{this};}
\DoxyCodeLine{93     \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=336pt]{classdata_1_1OleFile_aaf32e7bf59aafd720258d95446be5944_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdata_1_1OleFile_ab8ec9bb26796b85088a2854fc0dd6b46}\label{classdata_1_1OleFile_ab8ec9bb26796b85088a2854fc0dd6b46}} 
\index{data.OleFile@{data.OleFile}!saveAsFile@{saveAsFile}}
\index{saveAsFile@{saveAsFile}!data.OleFile@{data.OleFile}}
\doxysubsubsection{\texorpdfstring{saveAsFile()}{saveAsFile()}}
{\footnotesize\ttfamily boolean data.\+Ole\+File.\+save\+As\+File (\begin{DoxyParamCaption}\item[{String}]{outputfolder,  }\item[{String}]{newname,  }\item[{boolean}]{plainjson }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Saves the file wrapped within the \mbox{\hyperlink{classdata_1_1Ole}{Ole}} object but with a new name


\begin{DoxyParams}{Parameters}
{\em outputfolder} & Where to write the file \\
\hline
{\em newname} & The new name \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A boolean that says if the operation has been succesfull or not. 
\end{DoxyReturn}


Reimplemented from \mbox{\hyperlink{classdata_1_1Ole_acc9a93eae40397a78561ded24b3e69b4}{data.\+Ole}}.



Definition at line 139 of file Ole\+File.\+java.


\begin{DoxyCode}{0}
\DoxyCodeLine{139                                                                                       \{}
\DoxyCodeLine{140         String oldname = \mbox{\hyperlink{classdata_1_1Ole_a06b1a759588ab32503e78b2b281c4691}{getString}}(\textcolor{stringliteral}{"filename"}, \textcolor{stringliteral}{""}),}
\DoxyCodeLine{141                 name = FilenameUtils.getBaseName(oldname),}
\DoxyCodeLine{142                 extension = FilenameUtils.getExtension(oldname);}
\DoxyCodeLine{143         \textcolor{keyword}{set}(\textcolor{stringliteral}{"filename"}, newname + \textcolor{stringliteral}{"."} + extension);}
\DoxyCodeLine{144         \textcolor{keywordflow}{return} \mbox{\hyperlink{classdata_1_1OleFile_a98baacb5ed18c06071deeb652a71a334}{saveFile}}(outputfolder);}
\DoxyCodeLine{145     \}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classdata_1_1OleFile_ab8ec9bb26796b85088a2854fc0dd6b46_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classdata_1_1OleFile_a98baacb5ed18c06071deeb652a71a334}\label{classdata_1_1OleFile_a98baacb5ed18c06071deeb652a71a334}} 
\index{data.OleFile@{data.OleFile}!saveFile@{saveFile}}
\index{saveFile@{saveFile}!data.OleFile@{data.OleFile}}
\doxysubsubsection{\texorpdfstring{saveFile()}{saveFile()}}
{\footnotesize\ttfamily boolean data.\+Ole\+File.\+save\+File (\begin{DoxyParamCaption}\item[{String}]{outputfolder }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Given an encapsulated binary file obtained with the method \mbox{\hyperlink{}{data.\+Ole\+File\#load\+File(java.\+lang.\+String)}} it saves the image exactly with the concatenation of the name encapsulated in it, and the path specified in
\begin{DoxyParams}{Parameters}
{\em outputfolder.} & The file is sabed ~\newline
 in binary mode, so it mught be considered as a replica of the former file.\\
\hline
{\em outputfolder} & The folder on which to save the encapsulated file \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}

\end{DoxyReturn}


Definition at line 104 of file Ole\+File.\+java.


\begin{DoxyCode}{0}
\DoxyCodeLine{104                                                  \{}
\DoxyCodeLine{105         \textcolor{keywordtype}{boolean} res = \textcolor{keyword}{false};}
\DoxyCodeLine{106         \textcolor{keywordflow}{if} (getType().equals(oletype.OLEFILE.name())) \{}
\DoxyCodeLine{107             String filename = \textcolor{keyword}{get}(\textcolor{stringliteral}{"filename"}).asString();}
\DoxyCodeLine{108             JsonArray content = \textcolor{keyword}{get}(\textcolor{stringliteral}{"filedata"}).asArray();}
\DoxyCodeLine{109             \textcolor{keywordtype}{byte}[] bytedata = \textcolor{keyword}{new} \textcolor{keywordtype}{byte}[content.size()];}
\DoxyCodeLine{110             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < bytedata.length; i++) \{}
\DoxyCodeLine{111                 bytedata[i] = (byte) content.get(i).asInt();}
\DoxyCodeLine{112             \}}
\DoxyCodeLine{113             \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{114 \textcolor{comment}{//                Cryptor enigma = new Cryptor(meta().getString("crypto", ""));}}
\DoxyCodeLine{115                 FileOutputStream fos = \textcolor{keyword}{new} FileOutputStream(outputfolder + \textcolor{stringliteral}{"/"} + filename);}
\DoxyCodeLine{116                 \textcolor{keywordflow}{if} (!this.isEncrypted()) \{}
\DoxyCodeLine{117                     fos.write(bytedata);}
\DoxyCodeLine{118                 \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{119                     String scontent = \textcolor{keyword}{new} String(bytedata, myCryptor.getCharSet()),}
\DoxyCodeLine{120                             crypcontent = myCryptor.enCrypt(scontent);}
\DoxyCodeLine{121                     fos.write(crypcontent.getBytes());}
\DoxyCodeLine{122                 \}}
\DoxyCodeLine{123                 fos.close();}
\DoxyCodeLine{124                 res = \textcolor{keyword}{true};}
\DoxyCodeLine{125             \} \textcolor{keywordflow}{catch} (Exception ex) \{}
\DoxyCodeLine{126             \}}
\DoxyCodeLine{127         \}}
\DoxyCodeLine{128         \textcolor{keywordflow}{return} res;}
\DoxyCodeLine{129     \}}

\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
src/data/\mbox{\hyperlink{OleFile_8java}{Ole\+File.\+java}}\end{DoxyCompactItemize}
